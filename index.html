<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Encuesta de SatisfacciÃ³n - MSOLUCIONES</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --green:#16a34a;
  --gray:#f4f4f5;
  --dark:#111827;
}

* { box-sizing:border-box; font-family:system-ui, -apple-system, Segoe UI, Roboto; }

body {
  margin:0;
  background:#f5f6f8;
  padding:32px 16px;
}

.container {
  max-width:820px;
  margin:auto;
  background:white;
  border-radius:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.08);
  padding:32px;
}

.header {
  display:flex;
  align-items:center;
  gap:16px;
  margin-bottom:32px;
}

.logo-img {
  max-width: 320px;
  width: 100%;
  height: auto;
  display: block;
}

.card {
  background:#fafafa;
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:24px;
  margin-bottom:24px;
}

.card h3 {
  margin:0 0 16px 0;
  font-size:18px;
}

.grid {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}

label {
  font-size:12px;
  font-weight:700;
  color:#6b7280;
  margin-bottom:4px;
  display:block;
}

input, textarea {
  width:100%;
  padding:12px;
  border:1px solid #d1d5db;
  border-radius:8px;
  font-size:14px;
}

textarea { resize:none; }

.question {
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:20px;
  margin-bottom:20px;
}

.question h4 {
  margin:0 0 6px 0;
  font-size:16px;
}

.question p {
  margin:0 0 12px 0;
  font-size:14px;
  color:#6b7280;
}

.stars span {
  font-size:34px;
  cursor:pointer;
  color:#e5e7eb;
}

.stars span.active { color:#facc15; }

.nps {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.nps button {
  flex:1;
  min-width:40px;
  padding:12px 0;
  border:none;
  border-radius:8px;
  background:#f3f4f6;
  font-weight:700;
  cursor:pointer;
}

.nps button.active {
  background:var(--green);
  color:white;
}

.send {
  width:100%;
  background:linear-gradient(180deg,#111827,#020617);
  color:white;
  font-size:18px;
  font-weight:800;
  padding:18px;
  border:none;
  border-radius:14px;
  cursor:pointer;
  margin-top:16px;
}

footer {
  text-align:center;
  font-size:12px;
  color:#9ca3af;
  margin-top:24px;
}

.error {
  border-color: #dc2626 !important;
  background: #fef2f2;
}

.error-text {
  color: #dc2626;
  font-size: 13px;
  margin-top: 6px;
  font-weight: 600;
}

.success-text {
  color: #16a34a;
  font-size: 14px;
  font-weight: 700;
  margin-top: 12px;
}
</style>
</head>

<body>

<div class="container">

  <div class="header">
    <img src="logo-msoluciones.png" alt="MSoluciones" class="logo-img">
  </div>

  <div class="card">
    <h3>Datos del Cliente</h3>
    <div class="grid">
      <div>
        <label>Empresa / InstituciÃ³n</label>
        <input placeholder="Ej. ClÃ­nica Santa MarÃ­a">
      </div>
      <div>
        <label>Nombre</label>
        <input placeholder="Su nombre completo">
      </div>
      <div>
        <label>Cargo</label>
        <input placeholder="Ej. Jefe de Operaciones">
      </div>
      <div>
        <label>Correo electrÃ³nico</label>
        <input type="email" placeholder="correo@ejemplo.com">
      </div>
    </div>
  </div>

  <h3>EvaluaciÃ³n del Servicio</h3>
  <p style="color:#6b7280;margin-bottom:16px;">Califique del 1 al 5 donde 1 es Muy Malo y 5 es Excelente</p>

  <div class="question"><h4>#1 Calidad del Servicio</h4><p>Â¿CÃ³mo calificarÃ­a la calidad tÃ©cnica del mantenimiento realizado?</p><div class="stars"></div></div>
  <div class="question"><h4>#2 Cumplimiento de Requisitos</h4><p>Â¿El servicio cumpliÃ³ con los requisitos establecidos?</p><div class="stars"></div></div>
  <div class="question"><h4>#3 Entrega del Servicio</h4><p>Â¿El servicio se entregÃ³ de forma oportuna y puntual?</p><div class="stars"></div></div>
  <div class="question"><h4>#4 Cumplimiento de Expectativas</h4><p>Â¿El servicio cumpliÃ³ con sus expectativas?</p><div class="stars"></div></div>
  <div class="question"><h4>#5 Personal TÃ©cnico</h4><p>Â¿CÃ³mo evalÃºa el profesionalismo y conocimiento del personal?</p><div class="stars"></div></div>
  <div class="question"><h4>#6 ResoluciÃ³n</h4><p>Â¿El servicio resolviÃ³ efectivamente la falla?</p><div class="stars"></div></div>

  <div class="question">
    <h4>7. Â¿RecomendarÃ­a nuestros servicios?</h4>
    <div class="nps" id="nps"></div>
  </div>

  <div class="question">
    <label>Comentarios Adicionales (Opcional)</label>
    <textarea rows="4"></textarea>
  </div>

  <div id="mensajeError" class="error-text" style="display:none;"></div>
  <div id="mensajeSuccess" class="success-text" style="display:none;"></div>

  <button class="send" id="btnEnviar" onclick="enviar()">Enviar Encuesta</button>

  <footer>Â© 2026 SERVICIO Y MANTENCIONES MSOLUCIONES LTDA</footer>

</div>

<script>
document.querySelectorAll('.stars').forEach(block => {
  for (let i = 1; i <= 5; i++) {
    const s = document.createElement('span');
    s.innerHTML = 'â˜…';
    s.onclick = () => {
      [...block.children].forEach((c, idx) =>
        c.classList.toggle('active', idx < i)
      );
    };
    block.appendChild(s);
  }
});

const nps = document.getElementById('nps');
for (let i = 1; i <= 10; i++) {
  const b = document.createElement('button');
  b.textContent = i;
  b.onclick = () => {
    [...nps.children].forEach(c => c.classList.remove('active'));
    b.classList.add('active');
  };
  nps.appendChild(b);
}

function limpiarErrores() {
  document.querySelectorAll('.error').forEach(e => e.classList.remove('error'));
  document.getElementById("mensajeError").style.display = "none";
  document.getElementById("mensajeSuccess").style.display = "none";
}

function mostrarError(texto, elemento) {
  const msg = document.getElementById("mensajeError");
  msg.textContent = texto;
  msg.style.display = "block";
  if (elemento) elemento.classList.add("error");
}

function mostrarSuccess(texto) {
  const msg = document.getElementById("mensajeSuccess");
  msg.textContent = texto;
  msg.style.display = "block";
}

function getStars(i) {
  return [...document.querySelectorAll('.stars')[i].children]
    .filter(s => s.classList.contains('active')).length;
}

function todasLasEstrellasRespondidas() {
  for (let i = 0; i < 6; i++) {
    if (getStars(i) === 0) return false;
  }
  return true;
}

async function enviar() {
  limpiarErrores();
  const btn = document.getElementById("btnEnviar");
  btn.disabled = true;
  btn.textContent = "Enviandoâ€¦";

  const inputs = document.querySelectorAll('input');
  const textarea = document.querySelector('textarea');

  const data = {
    empresa: inputs[0].value,
    nombre: inputs[1].value,
    cargo: inputs[2].value,
    correo: inputs[3].value,
    q1: getStars(0),
    q2: getStars(1),
    q3: getStars(2),
    q4: getStars(3),
    q5: getStars(4),
    q6: getStars(5),
    nps: document.querySelector('.nps .active')?.textContent || '',
    comentarios: textarea.value
  };

  if (!data.empresa) return mostrarError("Debe indicar la empresa", inputs[0]);
  if (!data.nombre) return mostrarError("Debe indicar su nombre", inputs[1]);
  if (!data.cargo) return mostrarError("Debe indicar su cargo", inputs[2]);
  if (!data.correo) return mostrarError("Debe indicar un correo electrÃ³nico", inputs[3]);

  /* ðŸ”’ VALIDACIÃ“N DEL @ */
  if (!data.correo.includes("@")) {
    mostrarError("Debe indicar un correo electrÃ³nico vÃ¡lido", inputs[3]);
    btn.disabled = false;
    btn.textContent = "Enviar Encuesta";
    return;
  }

  if (!todasLasEstrellasRespondidas())
    return mostrarError("Debe responder todas las preguntas de evaluaciÃ³n");

  if (!data.nps)
    return mostrarError("Debe indicar quÃ© tan probable es que nos recomiende");

  await fetch("https://script.google.com/macros/s/AKfycbyzfIWTmXC_dPx73yR0iT2bLDqncfy1mmwQHxZF7rJ2uhhGai6cPj1vq2MFOfVXiX6O/exec", {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });

  mostrarSuccess("Gracias por responder la encuesta");
  btn.disabled = false;
  btn.textContent = "Enviar Encuesta";
}
</script>

</body>
</html>
