<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Encuesta de Satisfacción - MSOLUCIONES</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --green:#16a34a;
  --gray:#f4f4f5;
  --dark:#111827;
}

* { box-sizing:border-box; font-family:system-ui, -apple-system, Segoe UI, Roboto; }

body {
  margin:0;
  background:#f5f6f8;
  padding:32px 16px;
}

.container {
  max-width:820px;
  margin:auto;
  background:white;
  border-radius:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.08);
  padding:32px;
}

.header {
  display:flex;
  align-items:center;
  gap:16px;
  margin-bottom:32px;
}

.logo {
  width:48px;
  height:48px;
  border:2px solid var(--green);
  transform:rotate(45deg);
  display:flex;
  align-items:center;
  justify-content:center;
}

.logo span {
  transform:rotate(-45deg);
  color:var(--green);
  font-weight:900;
}

.header h1 {
  margin:0;
  font-size:14px;
  color:#16a34a;
  letter-spacing:.08em;
}

.header h2 {
  margin:0;
  font-size:28px;
  font-weight:900;
}

.card {
  background:#fafafa;
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:24px;
  margin-bottom:24px;
}

.card h3 {
  margin:0 0 16px 0;
  font-size:18px;
}

.grid {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}

label {
  font-size:12px;
  font-weight:700;
  color:#6b7280;
  margin-bottom:4px;
  display:block;
}

input, textarea {
  width:100%;
  padding:12px;
  border:1px solid #d1d5db;
  border-radius:8px;
  font-size:14px;
}

textarea { resize:none; }

.question {
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:20px;
  margin-bottom:20px;
}

.question h4 {
  margin:0 0 6px 0;
  font-size:16px;
}

.question p {
  margin:0 0 12px 0;
  font-size:14px;
  color:#6b7280;
}

.stars span {
  font-size:34px;
  cursor:pointer;
  color:#e5e7eb;
}

.stars span.active { color:#facc15; }

.nps {
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.nps button {
  flex:1;
  min-width:40px;
  padding:12px 0;
  border:none;
  border-radius:8px;
  background:#f3f4f6;
  font-weight:700;
  cursor:pointer;
}

.nps button.active {
  background:var(--green);
  color:white;
}

.send {
  width:100%;
  background:linear-gradient(180deg,#111827,#020617);
  color:white;
  font-size:18px;
  font-weight:800;
  padding:18px;
  border:none;
  border-radius:14px;
  cursor:pointer;
  margin-top:16px;
}

footer {
  text-align:center;
  font-size:12px;
  color:#9ca3af;
  margin-top:24px;
}
.logo-img {
  max-width: 320px;
  width: 100%;
  height: auto;
  display: block;
}
.nps-labels {
  display:flex;
  justify-content:space-between;
  font-size:12px;
  color:#9ca3af;
  margin-top:6px;
}

@media (max-width: 640px) {
  .nps-labels {
    display: none;
  }
}

@media (max-width: 640px) {
  .grid {
    grid-template-columns: 1fr;
  }

  .container {
    padding: 20px;
  }

  .card {
    padding: 20px;
  }
  @media (max-width: 640px) {
  input, textarea {
    font-size: 16px; 
}
}

.error {
  border-color: #dc2626 !important;
  background: #fef2f2;
}

.error-text {
  color: #dc2626;
  font-size: 13px;
  margin-top: 6px;
  font-weight: 600;
}

</style>
</head>

<body>

<div class="container">

  <div class="header">
  <img src="logo-msoluciones.png" alt="MSoluciones" class="logo-img">
</div>

  <div class="card">
    <h3>Datos del Cliente</h3>
    <div class="grid">
      <div>
        <label>Fecha</label>
        <input type="date">
      </div>
      <div>
        <label>Empresa / Institución</label>
        <input placeholder="Ej. Clínica Santa María">
      </div>
      <div>
        <label>Nombre quien califica</label>
        <input placeholder="Su nombre completo">
      </div>
      <div>
        <label>Cargo</label>
        <input placeholder="Ej. Jefe de Operaciones">
      </div>
    </div>
  </div>

  <h3>Evaluación del Servicio</h3>
  <p style="color:#6b7280;margin-bottom:16px;">Califique del 1 al 5 donde 1 es Muy Malo y 5 es Excelente</p>

  <div class="question">
    <h4>#1 Calidad del Servicio</h4>
    <p>¿Cómo calificaría la calidad técnica del mantenimiento realizado?</p>
    <div class="stars" data-q="q1"></div>
  </div>

  <div class="question">
    <h4>#2 Tiempos de Respuesta</h4>
    <p>¿El servicio se completó dentro de los plazos acordados?</p>
    <div class="stars" data-q="q2"></div>
  </div>

  <div class="question">
    <h4>#3 Personal Técnico</h4>
    <p>¿Cómo evalúa el profesionalismo y conocimiento del personal?</p>
    <div class="stars" data-q="q3"></div>
  </div>

  <div class="question">
    <h4>#4 Resolución</h4>
    <p>¿El servicio resolvió efectivamente la falla?</p>
    <div class="stars" data-q="q4"></div>
  </div>

  <div class="question">
    <h4>5. ¿Recomendaría nuestros servicios?</h4>
    <div class="nps" id="nps"></div>
    <div class="nps-labels">
      <span>Poco probable</span>
      <span>Muy probable</span>
    </div>
  </div>

  <div class="question">
    <label>Comentarios Adicionales (Opcional)</label>
    <textarea rows="4" placeholder="¿Hay algo más que debamos saber para mejorar?"></textarea>
  </div>
  
  <div id="mensajeError" class="error-text" style="display:none;"></div>

  <button class="send" id="btnEnviar" onclick="enviar()">
  Enviar Encuesta
  </button>

  <footer>© 2025 Servicios y Mantenciones MSoluciones</footer>

</div>

<script>
document.querySelectorAll('.stars').forEach(block => {
  for (let i = 1; i <= 5; i++) {
    const s = document.createElement('span');
    s.innerHTML = '★';
    s.onclick = () => {
      [...block.children].forEach((c, idx) =>
        c.classList.toggle('active', idx < i)
      );
    };
    block.appendChild(s);
  }
});

const nps = document.getElementById('nps');
for (let i = 1; i <= 10; i++) {
  const b = document.createElement('button');
  b.textContent = i;
  b.onclick = () => {
    [...nps.children].forEach(c => c.classList.remove('active'));
    b.classList.add('active');
  };
  nps.appendChild(b);
}

async function enviar() {
  const btn = document.getElementById("btnEnviar");

  btn.disabled = true;
  btn.textContent = "Enviando…";

  const inputs = document.querySelectorAll('input');
  const textarea = document.querySelector('textarea');

  const data = {
    fecha: inputs[0].value,
    empresa: inputs[1].value,
    nombre: inputs[2].value,
    cargo: inputs[3].value,
    q1: getStars(0),
    q2: getStars(1),
    q3: getStars(2),
    q4: getStars(3),
    nps: document.querySelector('.nps .active')?.textContent || '',
    comentarios: textarea.value
  };

if (!data.fecha || !data.empresa || !data.nombre || !data.cargo) {
  alert("Por favor complete todos los datos del cliente");
  btn.disabled = false;
  btn.textContent = "Enviar Encuesta";
  return;
}

if (!todasLasEstrellasRespondidas()) {
  alert("Por favor responda todas las preguntas de evaluación");
  btn.disabled = false;
  btn.textContent = "Enviar Encuesta";
  return;
}

if (!data.nps) {
  alert("Por favor indique qué tan probable es que nos recomiende");
  btn.disabled = false;
  btn.textContent = "Enviar Encuesta";
  return;
}


  try {
    await fetch("https://script.google.com/macros/s/AKfycbx-nK-58lqnIydtZdHCGoKsLb2kqeHqdTl6rH5xVaUB6HCFHSb9q7cIYohdVCTXWDZO/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    alert("Gracias por responder la encuesta");

    inputs.forEach(i => i.value = "");
    textarea.value = "";

    document.querySelectorAll('.stars span')
      .forEach(s => s.classList.remove('active'));

    document.querySelectorAll('.nps button')
      .forEach(b => b.classList.remove('active'));

    btn.disabled = false;
    btn.textContent = "Enviar Encuesta";

  } catch (e) {
    alert("Error al enviar, intente nuevamente");
    btn.disabled = false;
    btn.textContent = "Enviar Encuesta";
  }
}

function getStars(i) {
  return [...document.querySelectorAll('.stars')[i].children]
    .filter(s => s.classList.contains('active')).length;
}
function todasLasEstrellasRespondidas() {
  for (let i = 0; i < 4; i++) {
    if (getStars(i) === 0) {
      return false;
    }
  }
  return true;
}

</script>



</body>
</html>
